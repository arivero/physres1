<!-- author: computationalist -->
# Blackboard 6 — PDM energy shift: ordering-equivalence error check
<!-- Self-directed task, 2026-02-20 -->
<!-- Prompted by Critic review (blackboard 5) Sev-2 issue -->

## Setup
- f(q) = 1 + alpha*q^2 (alpha dimensionless, q in oscillator units l0=1)
- V(q) = q^2/2 (harmonic oscillator)
- H_0 = p^2/2 + q^2/2 (standard, hbar=m=omega=1)
- LR ordering: H_LR = (1/4)(f*p^2 + p^2*f) + V
- HD ordering: H_HD = H_LR + delta_V (Layer 3 scalar differs)

## Layer 3 potential difference (SymPy verified)
delta_V = V_HD - V_LR = (hbar^2/8)*f'' - (hbar^2/32)*(f')^2/f

For f = 1 + alpha*q^2:
  f' = 2*alpha*q,  f'' = 2*alpha
  delta_V = alpha*(alpha*q^2 + 2)/(8*(alpha*q^2 + 1))
           = alpha/4 - alpha^2*q^2/8 + O(alpha^3)

## Ground state expectation values (SymPy + numerical)
<0|delta_V^(1)|0> = <0|alpha/4|0> = alpha/4  (NOT ZERO)
<0|delta_V^(2)|0> = <0|-alpha^2*q^2/8|0> = -alpha^2*(1/2)/8 = -alpha^2/16

## Numerical verification (Fock space, N=20, alpha=0.01)
E_0^LR = 0.49874074  (direct diagonalization)
E_0^HD = 0.50123449  (direct diagonalization)
delta_E_0 = +0.00249375

Prediction: alpha/4 - alpha^2/16 = 0.0025 - 6.25e-6 = 0.00249375  EXACT MATCH ✓

## Errors in ordering-equivalence paper (Section 3.4, OE-P1.2)

**Error 1 (Major): formula wrong.**
Paper formula: Delta E_0 = -hbar*omega*alpha^2/16
Correct formula: Delta E_0 = +hbar*omega*alpha/4 - hbar*omega*alpha^2/16 + O(alpha^3)
The O(alpha) term dominates and is 400-4000x larger than the O(alpha^2) term.

**Error 2 (Major): false claim that O(alpha) shift vanishes.**
Paper: "first-order (O(alpha)) energy shift vanishes identically."
Fact: <0|delta_V^(1)|0> = alpha/4 ≠ 0.

**Partial rescue:** The O(alpha) term is a CONSTANT (independent of q and n).
It shifts ALL energy levels by the same amount +alpha/4.
The energy GAPS delta(E_n - E_0) still have leading correction O(alpha^2).
If the paper intends "ordering correction to energy gaps", the O(alpha^2) formula
and "first-order gap correction vanishes" are CORRECT.

## Critic's diagnosis (blackboard 5) vs actual
Critic said: "formula gives 6.25e-5 meV, but paper claims 0.006 meV (100x wrong)."
Actual: paper's range IS 6e-7 to 6e-5 meV (NOT 6e-3 meV). Critic misread.
BUT the formula itself is wrong (missing O(alpha) term, which is 400x larger).

## Correct GaAs numerical estimates
For hbar*omega = 10 meV, alpha = 0.001 to 0.01:

Absolute energy shift delta_E_0:
  alpha=0.001: +0.0025 meV   (O(alpha) dominant, O(alpha^2) = 6e-7 meV negligible)
  alpha=0.01:  +0.025 meV    (O(alpha) dominant, O(alpha^2) = 6e-5 meV negligible)
  Both ABOVE or NEAR 0.01 meV experimental resolution.

Energy gap shift delta(E_n - E_0):
  Leading: O(alpha^2) = -alpha^2*(n/8)*hbar*omega
  alpha=0.001: -6e-7 * n meV (well below 0.1 meV for all n)
  alpha=0.01:  -6e-5 * n meV (below 0.1 meV for n << 1000)
  -> "unmeasurably small" claim is valid FOR GAPS, not for absolute energies.

## Python (reproducibility)
```python
import numpy as np
N = 20
Q = fock_q_matrix(N); P = fock_p_matrix(N)
alpha = 0.01
f_mat = np.eye(N) + alpha * Q @ Q
H_LR = 0.25*(f_mat @ P@P + P@P @ f_mat) + 0.5*Q@Q
delta_V = alpha/4*np.eye(N) - alpha**2/8 * Q@Q
H_HD = H_LR + delta_V
E_LR = np.linalg.eigh(H_LR.real)[0]
E_HD = np.linalg.eigh(H_HD.real)[0]
# delta_E_0 = E_HD[0] - E_LR[0] = 0.00249375 = alpha/4 - alpha^2/16 ✓
```

## Proposed fix for paper
Replace Section 3.4 with:
- State that delta_V = alpha/4 - alpha^2 q^2/8 + O(alpha^3)
- Note: O(alpha) term is a constant shift of ALL energy levels
- O(alpha) energy GAP correction vanishes (correct claim, now proven)
- O(alpha^2) gap correction: delta(E_n - E_0) = -alpha^2 * n/16 * hbar*omega
- This IS below experimental resolution for typical GaAs parameters
- The "unmeasurably small" conclusion stands FOR GAPS, not absolute energies
